---
layout: blog
title:  "Drupal Module Development Basics: Create a voteapi module"
date:   2020-05-29 00:00:18 -0500
categories: posts
excerpt_separator: <!-- more -->
published: true
---

Create a single vote in a drupal module.

<!-- more -->


https://drupal.stackexchange.com/questions/270495/what-should-i-use-in-drupal-8-instead-of-votingapi-set-vote

VotingAPI docs are out of date. votingapi_set_vote() has been removed in Drupal 8.

What should I use in its place to programmatically set votes (for instance in a migration)?

{% highlight php %}
use Drupal\votingapi\Entity\Vote;

$vote = Vote::create(['type' => 'vote']); // this comes from /admin/structure/vote-types
$vote->setVotedEntityType('node'); // entity type
$vote->setVotedEntityId($nid); // node id
$vote->setValueType('points'); // this comes from /admin/structure/vote-types
$vote->setValue(1); // the number of points given per vote
$vote->setOwnerId($uid); // the user id of the person who casted the vote
$vote->setCreatedTime($timestamp) // timestamp of when vote was casted (optional)
// it will use the current time if you don't include it
$vote->save();
{% endhighlight %}


Drupal/modules/contrib/votingapi/src/Entity/Vote.php



Create a custom display field or sudo field

https://www.webomelette.com/creating-pseudo-fields-drupal-8
https://api.drupal.org/api/drupal/core%21lib%21Drupal%21Core%21Entity%21entity.api.php/function/hook_entity_extra_field_info/8.2.x


drupal attach a library to a theme

https://www.drupal.org/docs/theming-drupal/adding-stylesheets-css-and-javascript-js-to-a-drupal-theme

{% highlight php %}


(function ($) {
    "use strict";
    Drupal.behaviors.ThisIsWhatExactly?? = {
        attach: function (context, settings) {
            alert('working');
        }
    }
})(jQuery);


{% endhighlight %}

https://medium.com/@ragasirtahk/drupal-module-a-page-which-demonstrates-the-ajax-alert-command-cfb8184f29bd


Launching Drupal on Amazon Elastic Beanstalk.


Amazon AWS DEVOPS
Elastic Beanstalk
PHP 7.3running on 64bit Amazon Linux 2

Deploying a high-availability Drupal website with an external Amazon RDS database to Elastic Beanstalk
https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/php-hadrupal-tutorial.html

Deploying drupal on Elastic Beanstalk
https://github.com/aws-samples/eb-php-drupal

Using Elastic Beanstalk with Amazon Elastic File System
https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/services-efs.html

Using the EB CLI with Git
https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/eb3-cli-git.html

Deploying applications to Elastic Beanstalk environments
https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/using-features.deploy-existing-version.html

Using the EB CLI with Git

1. Launch an instance of Elastic Beanstalk.

1. Install Amazon CLI on your local environment.

3. Create a Mysql database.

3. Upload files to EB

https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/services-efs.html

"Elastic Beanstalk also provides sample applications that use Amazon EFS for shared storage. The two projects are configuration files that you can use with a standard WordPress or Drupal installer to run a blog or other content management system in a load balanced environment. When a user uploads a photo or other media, it is stored on an Amazon EFS file system, avoiding the need to use a plugin to store uploaded files in Amazon S3."

https://github.com/aws-samples/eb-php-drupal
